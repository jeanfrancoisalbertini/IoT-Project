#include <stdio.h>
#include <stdlib.h>
#include <limits.h>
#include <stdbool.h>
#include "pmsis.h"

#define INPUT_SIZE 2
#define EPOCHS 1000
#define LEARNING_RATE 0.01
#define MAX_SAMPLES 190 // Nombre total d'échantillons
#define UNIQUE_INDICES 10

// Paires de données fournies par l'utilisateur
double all_data[][2] = {
{0.0,1.738352154},{0.05,1.843936529},{0.10,1.948227644},{0.15,2.045393705},{0.20,2.145127026},{0.25,2.254323512},{0.30,2.371944258},{0.35,2.465137258},{0.40,2.573150767},{0.45,2.691392192},{0.50,2.787933546},{0.55,2.889562126},{0.60,2.988157249},{0.65,3.093709396},{0.70,3.197413563},{0.75,3.310724356},{0.80,3.414134243},{0.85,3.536591687},{0.90,3.633737892},
{0.0,1.731449749},{0.05,1.831072066},{0.10,1.968086831},{0.15,2.038143463},{0.20,2.164012683},{0.25,2.272332436},{0.30,2.35806869},{0.35,2.485291264},{0.40,2.595738027},{0.45,2.705457288},{0.50,2.80072354},{0.55,2.885515644},{0.60,3.001344072},{0.65,3.102608602},{0.70,3.230693915},{0.75,3.31208249},{0.80,3.432191334},{0.85,3.529854488},{0.90,3.637517769},
{0.0,1.732790242},{0.05,1.847721055},{0.10,1.952369458},{0.15,2.051283091},{0.20,2.139847636},{0.25,2.263102297},{0.30,2.362214026},{0.35,2.481828773},{0.40,2.591903954},{0.45,2.692905438},{0.50,2.785266535},{0.55,2.900811541},{0.60,3.012290916},{0.65,3.114361122},{0.70,3.190539339},{0.75,3.30705105},{0.80,3.428875815},{0.85,3.529135301},{0.90,3.624707614},
{0.0,1.745359259},{0.05,1.854584221},{0.10,1.940405794},{0.15,2.051352293},{0.20,2.147223787},{0.25,2.263953095},{0.30,2.371232125},{0.35,2.483695441},{0.40,2.585046058},{0.45,2.674205246},{0.50,2.775507991},{0.55,2.896166287},{0.60,2.998690585},{0.65,3.115828591},{0.70,3.195677493},{0.75,3.32742547},{0.80,3.428589002},{0.85,3.532044331},{0.90,3.631752987},
{0.0,1.750581366},{0.05,1.851768790},{0.10,1.938261359},{0.15,2.049152248},{0.20,2.159317627},{0.25,2.272619113},{0.30,2.377564661},{0.35,2.486678326},{0.40,2.586527429},{0.45,2.682864466},{0.50,2.789273909},{0.55,2.893214254},{0.60,3.00614134},{0.65,3.12205245},{0.70,3.224270051},{0.75,3.317192088},{0.80,3.429726497},{0.85,3.554830184},{0.90,3.636790345},
{0.0,1.742069432},{0.05,1.820380054},{0.10,1.944567668},{0.15,2.043983540},{0.20,2.161914823},{0.25,2.269977323},{0.30,2.360281493},{0.35,2.4729913},{0.40,2.584074886},{0.45,2.67937159},{0.50,2.792791428},{0.55,2.890284197},{0.60,3.002804699},{0.65,3.096511469},{0.70,3.215281599},{0.75,3.310882635},{0.80,3.4329696},{0.85,3.531625302},{0.90,3.635395497},
{0.0,1.756643817},{0.05,1.848351168},{0.10,1.931196773},{0.15,2.035773904},{0.20,2.158507160},{0.25,2.271084635},{0.30,2.3741792},{0.35,2.46829891},{0.40,2.586333093},{0.45,2.68198659},{0.50,2.791796719},{0.55,2.912527496},{0.60,3.013302534},{0.65,3.115174155},{0.70,3.207740729},{0.75,3.324230083},{0.80,3.432784102},{0.85,3.529705871},{0.90,3.651601718},
{0.0,1.720818608},{0.05,1.841620972},{0.10,1.965214159},{0.15,2.082504280},{0.20,2.138471916},{0.25,2.241897543},{0.30,2.383231811},{0.35,2.479326811},{0.40,2.582006149},{0.45,2.69671834},{0.50,2.779157934},{0.55,2.907491585},{0.60,2.999601168},{0.65,3.109859957},{0.70,3.21214582},{0.75,3.312344286},{0.80,3.4232123},{0.85,3.544076513},{0.90,3.627480106},
{0.0,1.736337987},{0.05,1.844876612},{0.10,1.948999321},{0.15,2.067387819},{0.20,2.165989402},{0.25,2.265424246},{0.30,2.360096896},{0.35,2.485590082},{0.40,2.577708214},{0.45,2.688689971},{0.50,2.784369377},{0.55,2.893870943},{0.60,3.004114034},{0.65,3.119131479},{0.70,3.219343044},{0.75,3.321912673},{0.80,3.418372694},{0.85,3.52919364},{0.90,3.632221321},
{0.0,1.737063959},{0.05,1.836059751},{0.10,1.935322689},{0.15,2.048789498},{0.20,2.170419753},{0.25,2.272887805},{0.30,2.358726491},{0.35,2.482654274},{0.40,2.584570511},{0.45,2.694831764},{0.50,2.783543907},{0.55,2.896627283},{0.60,3.025861468},{0.65,3.108808677},{0.70,3.203349632},{0.75,3.332618973},{0.80,3.421768832},{0.85,3.521568325},{0.90,3.642043081},
{0.0,1.752256374},{0.05,1.825024035},{0.10,1.948162745},{0.15,2.051230621},{0.20,2.169475611},{0.25,2.266724891},{0.30,2.368530723},{0.35,2.483526247},{0.40,2.576394262},{0.45,2.69095054},{0.50,2.799889333},{0.55,2.910887157},{0.60,3.012646662},{0.65,3.114759058},{0.70,3.221311455},{0.75,3.32683019},{0.80,3.435253982},{0.85,3.537617097},{0.90,3.643201841},
{0.0,1.741123843},{0.05,1.850461812},{0.10,1.932521463},{0.15,2.055968426},{0.20,2.152098882},{0.25,2.272243103},{0.30,2.374916825},{0.35,2.48913179},{0.40,2.57554955},{0.45,2.676987159},{0.50,2.789030783},{0.55,2.913694263},{0.60,2.991845893},{0.65,3.118001314},{0.70,3.219003027},{0.75,3.315851},{0.80,3.410896794},{0.85,3.524719259},{0.90,3.613983554},
{0.0,1.732872709},{0.05,1.836463323},{0.10,1.952780107},{0.15,2.052258041},{0.20,2.153863206},{0.25,2.284436834},{0.30,2.36866271},{0.35,2.477023865},{0.40,2.576795868},{0.45,2.694224201},{0.50,2.79683283},{0.55,2.906787762},{0.60,3.012382244},{0.65,3.102489982},{0.70,3.211578356},{0.75,3.316314246},{0.80,3.417231456},{0.85,3.530319179},{0.90,3.629802144},
{0.0,1.741653277},{0.05,1.838235967},{0.10,1.945141992},{0.15,2.046675817},{0.20,2.147627842},{0.25,2.275710816},{0.30,2.36048445},{0.35,2.486111455},{0.40,2.578611951},{0.45,2.671412137},{0.50,2.796323939},{0.55,2.892503082},{0.60,2.991942056},{0.65,3.101996441},{0.70,3.213941971},{0.75,3.336823889},{0.80,3.433308481},{0.85,3.537060666},{0.90,3.626953818},
{0.0,1.742535546},{0.05,1.843217417},{0.10,1.947376744},{0.15,2.061719762},{0.20,2.160304241},{0.25,2.251993092},{0.30,2.369799193},{0.35,2.473952027},{0.40,2.579573546},{0.45,2.692913915},{0.50,2.788413783},{0.55,2.889933407},{0.60,3.001283393},{0.65,3.093316605},{0.70,3.20574223},{0.75,3.315744639},{0.80,3.431335412},{0.85,3.536377646},{0.90,3.63356072},
{0.0,1.737937362},{0.05,1.866901279},{0.10,1.950575066},{0.15,2.040996246},{0.20,2.160323430},{0.25,2.254924099},{0.30,2.370718404},{0.35,2.481965489},{0.40,2.604811209},{0.45,2.690912395},{0.50,2.770530799},{0.55,2.903277428},{0.60,3.004077992},{0.65,3.10573209},{0.70,3.203463727},{0.75,3.320464312},{0.80,3.417920033},{0.85,3.512264823},{0.90,3.638872678},
{0.0,1.715836347},{0.05,1.864470145},{0.10,1.955493793},{0.15,2.071951796},{0.20,2.150087393},{0.25,2.262007162},{0.30,2.364202099},{0.35,2.460034663},{0.40,2.567260822},{0.45,2.695920309},{0.50,2.793968171},{0.55,2.887124213},{0.60,3.009884354},{0.65,3.110161551},{0.70,3.208142732},{0.75,3.320712514},{0.80,3.420807218},{0.85,3.504677644},{0.90,3.638169227},
{0.0,1.746341921},{0.05,1.828347270},{0.10,1.938858926},{0.15,2.034747120},{0.20,2.166997637},{0.25,2.256799039},{0.30,2.35744282},{0.35,2.489491546},{0.40,2.568775747},{0.45,2.670718602},{0.50,2.797378284},{0.55,2.8850528},{0.60,2.997211706},{0.65,3.099175704},{0.70,3.222314944},{0.75,3.326700994},{0.80,3.421317433},{0.85,3.521281161},{0.90,3.645129913},
{0.0,1.701195693},{0.05,1.836792531},{0.10,1.932286140},{0.15,2.049146071},{0.20,2.166323758},{0.25,2.262435450},{0.30,2.373001297},{0.35,2.456321417},{0.40,2.581953839},{0.45,2.68287966},{0.50,2.782812819},{0.55,2.892209188},{0.60,3.006562902},{0.65,3.107327398},{0.70,3.209632656},{0.75,3.319605539},{0.80,3.420121414},{0.85,3.544817195},{0.90,3.63819774},
{0.0,1.737206007},{0.05,1.851407699},{0.10,1.945917684},{0.15,2.061105336},{0.20,2.164373444},{0.25,2.275506077},{0.30,2.368818604},{0.35,2.476127051},{0.40,2.578987138},{0.45,2.685095151},{0.50,2.790169614},{0.55,2.905320352},{0.60,3.018881691},{0.65,3.103043058},{0.70,3.207513632},{0.75,3.32111512},{0.80,3.398442904},{0.85,3.530648891},{0.90,3.636875333},
{0.0,1.720597796},{0.05,1.820803615},{0.10,1.938727513},{0.15,2.053558568},{0.20,2.150267539},{0.25,2.257911291},{0.30,2.365017861},{0.35,2.470608386},{0.40,2.572191747},{0.45,2.685919535},{0.50,2.785922147},{0.55,2.897354373},{0.60,2.982129474},{0.65,3.102290174},{0.70,3.202237187},{0.75,3.320674136},{0.80,3.418602166},{0.85,3.526780635},{0.90,3.643176846},
{0.0,1.732560002},{0.05,1.853974140},{0.10,1.951206461},{0.15,2.037348866},{0.20,2.144417164},{0.25,2.260363902},{0.30,2.362335343},{0.35,2.462480657},{0.40,2.582763124},{0.45,2.693679587},{0.50,2.807352136},{0.55,2.898210974},{0.60,2.990416843},{0.65,3.114400373},{0.70,3.200695386},{0.75,3.344342662},{0.80,3.425965999},{0.85,3.526739276},{0.90,3.638007561},
{0.0,1.750096686},{0.05,1.838381483},{0.10,1.928409803},{0.15,2.061597766},{0.20,2.164324433},{0.25,2.260948893},{0.30,2.363644468},{0.35,2.477428749},{0.40,2.587023162},{0.45,2.691922963},{0.50,2.790033096},{0.55,2.907009053},{0.60,3.013133733},{0.65,3.114770337},{0.70,3.212251068},{0.75,3.326213316},{0.80,3.447391147},{0.85,3.53867981},{0.90,3.620474861},
{0.0,1.730976362},{0.05,1.855526819},{0.10,1.955542397},{0.15,2.054011863},{0.20,2.172274349},{0.25,2.269970181},{0.30,2.359975786},{0.35,2.477392916},{0.40,2.567956037},{0.45,2.691436178},{0.50,2.792377966},{0.55,2.898107835},{0.60,2.998244839},{0.65,3.118090132},{0.70,3.222432254},{0.75,3.308687727},{0.80,3.408249115},{0.85,3.531603},{0.90,3.634819145},
{0.0,1.755282908},{0.05,1.832735065},{0.10,1.950020583},{0.15,2.044232706},{0.20,2.144900922},{0.25,2.273593350},{0.30,2.358246786},{0.35,2.488182579},{0.40,2.575414582},{0.45,2.686701325},{0.50,2.779860686},{0.55,2.884375931},{0.60,3.000802546},{0.65,3.095757492},{0.70,3.2243447},{0.75,3.305278157},{0.80,3.416519979},{0.85,3.533056229},{0.90,3.617173712},
{0.0,1.743895217},{0.05,1.832309154},{0.10,1.935841029},{0.15,2.056416515},{0.20,2.135720290},{0.25,2.261730325},{0.30,2.381302032},{0.35,2.475439114},{0.40,2.566614189},{0.45,2.701676125},{0.50,2.782985085},{0.55,2.904182493},{0.60,3.01042367},{0.65,3.105245869},{0.70,3.217631654},{0.75,3.30130423},{0.80,3.419020666},{0.85,3.507393144},{0.90,3.644827652},
{0.0,1.73364656},{0.05,1.864677908},{0.10,1.943784239},{0.15,2.059940988},{0.20,2.172163263},{0.25,2.260054136},{0.30,2.366233139},{0.35,2.479846767},{0.40,2.58032903},{0.45,2.681665046},{0.50,2.776773162},{0.55,2.900524974},{0.60,3.023414935},{0.65,3.113158009},{0.70,3.208939473},{0.75,3.335853432},{0.80,3.413452619},{0.85,3.526557814},{0.90,3.612642313},
{0.0,1.727075795},{0.05,1.847414011},{0.10,1.955335273},{0.15,2.074223811},{0.20,2.157185460},{0.25,2.272560896},{0.30,2.351357403},{0.35,2.476501365},{0.40,2.581131246},{0.45,2.685927499},{0.50,2.797624644},{0.55,2.894877659},{0.60,2.98816537},{0.65,3.093672481},{0.70,3.208353818},{0.75,3.309263369},{0.80,3.416137664},{0.85,3.528490044},{0.90,3.628222561},
{0.0,1.731152089},{0.05,1.838436202},{0.10,1.971221300},{0.15,2.051441589},{0.20,2.169580247},{0.25,2.270457791},{0.30,2.363765309},{0.35,2.488747196},{0.40,2.586319},{0.45,2.679149098},{0.50,2.796410657},{0.55,2.8916312},{0.60,2.992094415},{0.65,3.125874491},{0.70,3.215686193},{0.75,3.327373983},{0.80,3.403632956},{0.85,3.519697889},{0.90,3.634663538},
{0.0,1.739856059},{0.05,1.831204237},{0.10,1.943445752},{0.15,2.049437353},{0.20,2.167657316},{0.25,2.268106798},{0.30,2.379251561},{0.35,2.485376025},{0.40,2.568629577},{0.45,2.68430074},{0.50,2.782055935},{0.55,2.890315723},{0.60,3.000409322},{0.65,3.108939609},{0.70,3.221404246},{0.75,3.322790805},{0.80,3.421751218},{0.85,3.528068668},{0.90,3.633338732},
{0.0,1.71240579},{0.05,1.852567386},{0.10,1.960776265},{0.15,2.047331358},{0.20,2.145616398},{0.25,2.295886937},{0.30,2.363266178},{0.35,2.474177017},{0.40,2.582468177},{0.45,2.692171898},{0.50,2.819215231},{0.55,2.895521489},{0.60,3.001189428},{0.65,3.101156868},{0.70,3.221772296},{0.75,3.302185356},{0.80,3.4176903},{0.85,3.52227499},{0.90,3.652550204},
{0.0,1.742261731},{0.05,1.844954968},{0.10,1.938350092},{0.15,2.033109424},{0.20,2.153483399},{0.25,2.263541957},{0.30,2.386421094},{0.35,2.475313822},{0.40,2.57806017},{0.45,2.672642602},{0.50,2.799530142},{0.55,2.88775642},{0.60,3.002252878},{0.65,3.116935217},{0.70,3.190840619},{0.75,3.337681219},{0.80,3.42822522},{0.85,3.53699718},{0.90,3.634275537},
{0.0,1.738905761},{0.05,1.818893947},{0.10,1.949025551},{0.15,2.057593221},{0.20,2.149452769},{0.25,2.266637699},{0.30,2.36085253},{0.35,2.491864797},{0.40,2.59341279},{0.45,2.686825327},{0.50,2.794396679},{0.55,2.890639652},{0.60,2.998059679},{0.65,3.110378457},{0.70,3.211565212},{0.75,3.322975587},{0.80,3.423449474},{0.85,3.522590038},{0.90,3.627582029},
{0.0,1.744299762},{0.05,1.832501021},{0.10,1.944881674},{0.15,2.031835303},{0.20,2.159598983},{0.25,2.262389640},{0.30,2.361117998},{0.35,2.471675763},{0.40,2.582560727},{0.45,2.677567837},{0.50,2.809500627},{0.55,2.880894802},{0.60,3.013380791},{0.65,3.107699645},{0.70,3.20236205},{0.75,3.335654051},{0.80,3.433533566},{0.85,3.541344958},{0.90,3.639591096},
{0.0,1.756586177},{0.05,1.871234168},{0.10,1.950359217},{0.15,2.049681039},{0.20,2.169465206},{0.25,2.269389161},{0.30,2.358316384},{0.35,2.48265041},{0.40,2.574121411},{0.45,2.692799866},{0.50,2.765781913},{0.55,2.890575137},{0.60,2.99208871},{0.65,3.099805209},{0.70,3.207317369},{0.75,3.320879072},{0.80,3.439082761},{0.85,3.52787172},{0.90,3.621653841},
{0.0,1.732873668},{0.05,1.841416216},{0.10,1.941975525},{0.15,2.049629094},{0.20,2.158362041},{0.25,2.257974958},{0.30,2.380286103},{0.35,2.465286937},{0.40,2.577203931},{0.45,2.665262198},{0.50,2.789428154},{0.55,2.888829266},{0.60,3.00322409},{0.65,3.088953168},{0.70,3.229382134},{0.75,3.319248242},{0.80,3.424093932},{0.85,3.53725347},{0.90,3.639174236},
{0.0,1.726305688},{0.05,1.821538488},{0.10,1.932742700},{0.15,2.060830862},{0.20,2.136801764},{0.25,2.273302017},{0.30,2.362846657},{0.35,2.466451025},{0.40,2.574131049},{0.45,2.665360779},{0.50,2.790091988},{0.55,2.901538074},{0.60,3.011081798},{0.65,3.096971414},{0.70,3.204254558},{0.75,3.307259444},{0.80,3.410494986},{0.85,3.551146723},{0.90,3.636230234},
{0.0,1.747907453},{0.05,1.832653726},{0.10,1.944248905},{0.15,2.024667600},{0.20,2.170155153},{0.25,2.281515972},{0.30,2.372820741},{0.35,2.482698312},{0.40,2.593883466},{0.45,2.701158956},{0.50,2.792338149},{0.55,2.910311226},{0.60,3.00493632},{0.65,3.100150765},{0.70,3.195191885},{0.75,3.317828622},{0.80,3.425316651},{0.85,3.528966436},{0.90,3.629793456},
{0.0,1.745056939},{0.05,1.837334855},{0.10,1.951353278},{0.15,2.061560163},{0.20,2.157828897},{0.25,2.264077830},{0.30,2.352166467},{0.35,2.480553537},{0.40,2.574382256},{0.45,2.68342182},{0.50,2.779955642},{0.55,2.906116405},{0.60,2.994963062},{0.65,3.111132369},{0.70,3.21380013},{0.75,3.31882386},{0.80,3.436857977},{0.85,3.543244057},{0.90,3.627500511},
{0.0,1.734681805},{0.05,1.848479662},{0.10,1.941895209},{0.15,2.047186871},{0.20,2.153206814},{0.25,2.262541703},{0.30,2.362920963},{0.35,2.484651408},{0.40,2.563424898},{0.45,2.66523334},{0.50,2.795632457},{0.55,2.906229791},{0.60,3.002389874},{0.65,3.112752074},{0.70,3.210785084},{0.75,3.302242104},{0.80,3.421920661},{0.85,3.51757352},{0.90,3.621816163},
{0.0,1.730176406},{0.05,1.839906352},{0.10,1.945113164},{0.15,2.039449293},{0.20,2.136770416},{0.25,2.257590296},{0.30,2.375240038},{0.35,2.467738571},{0.40,2.577480823},{0.45,2.668054646},{0.50,2.7681676},{0.55,2.902523662},{0.60,2.998010363},{0.65,3.098754085},{0.70,3.207874311},{0.75,3.317263443},{0.80,3.426751622},{0.85,3.546531609},{0.90,3.614936264},
{0.0,1.738600283},{0.05,1.842549645},{0.10,1.950976637},{0.15,2.052292233},{0.20,2.161541399},{0.25,2.258489209},{0.30,2.355843702},{0.35,2.484250379},{0.40,2.590928287},{0.45,2.684046804},{0.50,2.791412952},{0.55,2.901227502},{0.60,2.995187485},{0.65,3.114888854},{0.70,3.220824442},{0.75,3.319085094},{0.80,3.413212249},{0.85,3.516213871},{0.90,3.629480846},
{0.0,1.724813288},{0.05,1.841355294},{0.10,1.952348929},{0.15,2.054712941},{0.20,2.160253987},{0.25,2.246189605},{0.30,2.369148958},{0.35,2.475789742},{0.40,2.586126164},{0.45,2.687989882},{0.50,2.794727883},{0.55,2.903261443},{0.60,3.014715863},{0.65,3.113281262},{0.70,3.21769114},{0.75,3.31024112},{0.80,3.437967257},{0.85,3.527644247},{0.90,3.64149335},
{0.0,1.736772057},{0.05,1.831930608},{0.10,1.939620714},{0.15,2.048137457},{0.20,2.161187974},{0.25,2.262687749},{0.30,2.374131747},{0.35,2.473595744},{0.40,2.581134097},{0.45,2.688291477},{0.50,2.789928854},{0.55,2.888463166},{0.60,2.999207647},{0.65,3.105352083},{0.70,3.215789029},{0.75,3.321558661},{0.80,3.426913702},{0.85,3.525029799},{0.90,3.62658167},
{0.0,1.729731865},{0.05,1.853261935},{0.10,1.944272927},{0.15,2.037684928},{0.20,2.147021530},{0.25,2.254411509},{0.30,2.386432185},{0.35,2.49096194},{0.40,2.597347308},{0.45,2.695585938},{0.50,2.79398188},{0.55,2.904093581},{0.60,2.995404304},{0.65,3.097094803},{0.70,3.209260321},{0.75,3.305326316},{0.80,3.418653982},{0.85,3.516806655},{0.90,3.649567327},
{0.0,1.727918035},{0.05,1.837881152},{0.10,1.955662631},{0.15,2.064443617},{0.20,2.150500559},{0.25,2.275783864},{0.30,2.375058589},{0.35,2.48844093},{0.40,2.573616138},{0.45,2.688245436},{0.50,2.782701812},{0.55,2.883776052},{0.60,2.993624629},{0.65,3.115527492},{0.70,3.215530845},{0.75,3.31171518},{0.80,3.406135153},{0.85,3.515217745},{0.90,3.624837817},
{0.0,1.745790646},{0.05,1.836899772},{0.10,1.950264252},{0.15,2.054352837},{0.20,2.148638909},{0.25,2.264783365},{0.30,2.378114751},{0.35,2.451559702},{0.40,2.582083616},{0.45,2.684181184},{0.50,2.795834029},{0.55,2.901949291},{0.60,3.002396313},{0.65,3.105309876},{0.70,3.209116788},{0.75,3.318506549},{0.80,3.415999093},{0.85,3.534761992},{0.90,3.655129226},
{0.0,1.736414601},{0.05,1.843483775},{0.10,1.933477680},{0.15,2.045310659},{0.20,2.175677714},{0.25,2.263774277},{0.30,2.365105168},{0.35,2.477635377},{0.40,2.570774918},{0.45,2.695393589},{0.50,2.786592412},{0.55,2.88743743},{0.60,2.98622591},{0.65,3.09647224},{0.70,3.21389064},{0.75,3.311401667},{0.80,3.412603541},{0.85,3.514406127},{0.90,3.626799149},
{0.0,1.749622076},{0.05,1.840864414},{0.10,1.962435364},{0.15,2.064543087},{0.20,2.149598147},{0.25,2.277210474},{0.30,2.362859546},{0.35,2.46556807},{0.40,2.571614088},{0.45,2.70550465},{0.50,2.773747199},{0.55,2.886056608},{0.60,2.984722735},{0.65,3.109129962},{0.70,3.217795854},{0.75,3.321670573},{0.80,3.41794982},{0.85,3.514891336},{0.90,3.634713904},
{0.0,1.725247368},{0.05,1.836318577},{0.10,1.940790279},{0.15,2.056051119},{0.20,2.155835069},{0.25,2.245468466},{0.30,2.36921245},{0.35,2.47107497},{0.40,2.57604985},{0.45,2.68518295},{0.50,2.78723650},{0.55,2.89122644},{0.60,3.00311329},{0.65,3.11184294},{0.70,3.21542643},{0.75,3.31382453},{0.80,3.42634347},{0.85,3.53958688},{0.90,3.64807071}
};

// Indices pour les tests
int test_indices[] = {0, 10, 20, 30, 40, 50, 60, 70, 80, 90, 100, 110, 120, 130, 140, 150, 160, 170, 180};

// Variables globales pour le réseau neuronal
double weights[INPUT_SIZE];
double bias;

// Générateur de nombres aléatoires
static unsigned long x, y, z;

// Fonction de génération de nombres pseudo-aléatoires
unsigned long xorshf96(void) {
    unsigned long t;
    x ^= x << 16;
    x ^= x >> 5;
    x ^= x << 1;
    t = x;
    x = y;
    y = z;
    z = t ^ x ^ y;
    return z;
}

// Initialisation du générateur de nombres aléatoires avec une graine pseudo-aléatoire
void initialize_rng() {
    volatile unsigned long seed = 0;
    for (volatile int i = 0; i < 1000 + (xorshf96() % 1000); i++) {
        seed += i;
    }
    x = 123456789 + seed;
    y = 362436069;
    z = 521288629 + seed;
}

// Initialisation du réseau neuronal
void initialize() {
    for (int i = 0; i < INPUT_SIZE; i++) {
        weights[i] = ((double)xorshf96() / ULONG_MAX) * 2 - 1; // Initialise les poids aléatoirement
    }
    bias = ((double)xorshf96() / ULONG_MAX) * 2 - 1; // Initialise le biais aléatoirement
}

// Fonction d'activation ReLU
double relu(double x) {
    return (x > 0) ? x : 0;
}

// Fonction de prédiction utilisant la propagation avant
double predict(double inputs[]) {
    double output = bias;
    for (int i = 0; i < INPUT_SIZE; i++) {
        output += weights[i] * inputs[i];
    }
    return relu(output);
}

// Fonction d'entraînement du réseau neuronal
void train(double inputs[], double target) {
    double prediction = predict(inputs);
    double error = target - prediction;
    if (prediction > 0) { // Mise à jour des poids uniquement si la prédiction est positive
        for (int i = 0; i < INPUT_SIZE; i++) {
            weights[i] += LEARNING_RATE * error * inputs[i];
        }
        bias += LEARNING_RATE * error;
    }
}

// Génération d'une liste aléatoire de 10 nombres uniques entre 0 et 50
void generate_random_list(int list[], int size, int min, int max) {
    bool chosen[max - min + 1];
    for (int i = 0; i < max - min + 1; i++) {
        chosen[i] = false;
    }
    int count = 0;
    while (count < size) {
        int num = (xorshf96() % (max - min + 1)) + min;
        if (!chosen[num - min]) {
            list[count++] = num;
            chosen[num - min] = true;
        }
    }
}

// Sélection des données d'entraînement en utilisant des indices aléatoires
void select_training_data_with_random_indices(double training_data[][INPUT_SIZE], double all_data[][2], int random_indices[], int size) {
    int idx = 0;
    for (int i = 0; i < size; i++) {
        int base_idx = random_indices[i] * 19;
        for (int j = 0; j < 19; j++) {
            training_data[idx][0] = all_data[base_idx + j][0];
            training_data[idx][1] = all_data[base_idx + j][1];
            idx++;
        }
    }
}

int main() {
    // Initialisation du générateur de nombres aléatoires et du réseau neuronal
    initialize_rng();
    initialize();

    // Préparation des données d'entraînement
    double training_data[MAX_SAMPLES][INPUT_SIZE] = {0};
    double targets[MAX_SAMPLES] = {
        1.736111111, 1.841533879, 1.946956647, 2.052379414, 2.157802182,
        2.26322495, 2.368647717, 2.474070485, 2.579493253, 2.684916021,
        2.790338788, 2.895761556, 3.001184324, 3.106607092, 3.212029859,
        3.317452627, 3.422875395, 3.528298163, 3.63372093
    };
    int random_indices[UNIQUE_INDICES];
    generate_random_list(random_indices, UNIQUE_INDICES, 0, 50);
    select_training_data_with_random_indices(training_data, all_data, random_indices, UNIQUE_INDICES);

    // Configuration des compteurs de performances pour le profiling
    pi_perf_conf(
        1<<PI_PERF_ACTIVE_CYCLES |
        1<<PI_PERF_INSTR |
        1<<PI_PERF_LD_STALL |
        1<<PI_PERF_JR_STALL |
        1<<PI_PERF_LD |
        1<<PI_PERF_LD_EXT_CYC |
        1<<PI_PERF_ST
    );

    pi_perf_reset(); // Réinitialisation de tous les compteurs
    pi_perf_start(); // Début de la mesure

    // Entraînement du réseau neuronal
    for (int epoch = 0; epoch < EPOCHS; epoch++) {
        for (int i = 0; i < MAX_SAMPLES; i++) {
            train(training_data[i], targets[i % 19]); // Utilisation de i % 19 pour les cibles
        }
    }

    // Test du réseau sur des indices spécifiques
    printf("\nTest du réseau neuronal sur des indices spécifiques :\n");
    for (int i = 0; i < sizeof(test_indices) / sizeof(test_indices[0]); i++) {
        int idx = test_indices[i];
        double prediction = predict(training_data[idx]);
        printf("Entrée: [%lf, %lf], Cible: %lf, Prédiction: %lf\n",
               training_data[idx][0], training_data[idx][1], targets[idx % 19], prediction);
    }

    pi_perf_stop(); // Arrêt de la mesure

    // Lecture et affichage des métriques de performance
    unsigned int total_cycles = pi_perf_read(PI_PERF_CYCLES);
    unsigned int active_cycles = pi_perf_read(PI_PERF_ACTIVE_CYCLES);
    unsigned int executed_instructions = pi_perf_read(PI_PERF_INSTR);
    unsigned int load_stalls = pi_perf_read(PI_PERF_LD_STALL);
    unsigned int instruction_misses = pi_perf_read(PI_PERF_IMISS);
    unsigned int load_ext_cycles = pi_perf_read(PI_PERF_LD_EXT_CYC);

    printf("Analyse de performance:\n");
    printf("Cycles Totaux: %u\n", total_cycles);
    printf("Cycles Actifs: %u\n", active_cycles);
    printf("Instructions Exécutées: %u\n", executed_instructions);
    printf("Stalls de Chargement: %u\n", load_stalls);
    printf("Ratés d'Instruction: %u\n", instruction_misses);
    printf("Cycles de Chargement Externes: %u\n", load_ext_cycles);

    return 0;
}
